# ============================================================
# å¼€å‘è¿›åº¦é¡µ
# route: /projects/[id]/progress
# ============================================================

meta:
  route: /projects/[id]/progress
  layout: dashboard
  auth: true
  params: { id: projectId }

# ============================================================
# ç»“æ„
# ============================================================
structure:
  type: single-column
  maxWidth: 1200px

sections:

  # è¿›åº¦è‹±é›„åŒº
  - id: progress-hero
    type: ProgressHero
    props:
      percentage: ${progress.percentage}
      currentStage: ${progress.currentStage}
      eta: ${progress.eta}
      stages: [éœ€æ±‚, è®¾è®¡, å¼€å‘, æµ‹è¯•, éƒ¨ç½²]
    className: bg-gradient-to-r from-primary-50 to-warm-50 rounded-2xl p-8 mb-8

  # ä¸»å†…å®¹ (ä¸¤åˆ—)
  - id: main
    type: TwoColumn
    gap: 6
    
    left:
      # å®æ—¶é¢„è§ˆ
      - type: LivePreviewCard
        props:
          previewUrl: ${deployment.previewUrl}
          currentPage: ${progress.currentPage}
          refreshInterval: 5000
      
      # å¼€å‘æ—¥å¿—
      - type: LogStream
        props:
          logs: ${progress.logs}
          maxHeight: 300px
          autoScroll: true
    
    right:
      # AIå›¢é˜ŸçŠ¶æ€
      - type: TeamStatus
        props:
          agents:
            - { avatar: ğŸ‘¨â€ğŸ’¼, name: äº§å“ç»ç†, status: completed }
            - { avatar: ğŸ¨, name: è®¾è®¡å¸ˆ, status: completed }
            - { avatar: ğŸ‘¨â€ğŸ’», name: å¼€å‘è€…, status: working }
            - { avatar: ğŸ§ª, name: æµ‹è¯•å‘˜, status: waiting }
            - { avatar: ğŸš€, name: è¿ç»´, status: waiting }
      
      # ç­‰å¾…ä»»åŠ¡
      - type: WaitingTasks
        props:
          tasks:
            - { icon: ğŸŒ, title: å‡†å¤‡åŸŸå, action: openDomainModal }
            - { icon: ğŸ¨, title: ä¸Šä¼ Logo, action: openLogoModal }
            - { icon: ğŸ“–, title: äº†è§£SEO, href: /learn/seo }
      
      # ç¦»å¼€æç¤º
      - type: NoticeCard
        props:
          icon: ğŸ“±
          title: å¯ä»¥ç¦»å¼€è¿™ä¸ªé¡µé¢
          message: å®Œæˆæ—¶ä¼šé€šçŸ¥ä½ 

# ============================================================
# çŠ¶æ€
# ============================================================
state:
  project: Project
  progress: ProjectProgress

# ============================================================
# API
# ============================================================
api:
  onMount:
    - endpoint: projects.get
      input: { id: projectId }
      set: project
    
    - endpoint: progress.get
      input: { projectId }
      set: progress

  subscription:
    endpoint: progress.stream
    input: { projectId }
    onEvent: |
      switch(event.type) {
        case 'percentage_update': updatePercentage(event.data)
        case 'stage_change': updateStage(event.data)
        case 'log': appendLog(event.data)
        case 'completed': router.push(`/projects/${projectId}/complete`)
      }
